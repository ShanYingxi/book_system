<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>ç”¨æˆ·æ³¨å†Œ</title>
    <style>
        body { font-family: sans-serif; padding: 40px; max-width: 500px; margin: auto; }
        h2 { color: #333; }
        input, select, button {
            display: block;
            width: 100%;
            padding: 8px;
            margin-top: 10px;
        }
        .msg { margin-top: 20px; color: green; }
        .error { color: red; }
    </style>
</head>
<nav style="margin-bottom: 20px;">
    <a href="/">ğŸ“š å›¾ä¹¦åˆ—è¡¨</a> |
    <a href="/register">ğŸ“ æ³¨å†Œ</a> |
    <a href="/add_book">ğŸ“– å‘å¸ƒå›¾ä¹¦</a> |
    <a href="/orders">ğŸ“¦ æˆ‘çš„è®¢å•</a> |
    <a href="/book_types_view">ğŸ“‚ å›¾ä¹¦åˆ†ç±»</a> |
    <a href="/update_user">âš™ï¸ ä¿®æ”¹ç”¨æˆ·</a> |
    <a href="/delete_user">ğŸ—‘ï¸ åˆ é™¤ç”¨æˆ·</a>
  </nav>
  
<body>
    <h2>ğŸ“‹ ç”¨æˆ·æ³¨å†Œ</h2>
    <form id="registerForm">
        <input type="text" name="username" placeholder="ç”¨æˆ·å" required />
        <input type="password" name="password" placeholder="å¯†ç ï¼ˆ6ä½å­—æ¯æ•°å­—ï¼‰" required />
        <input type="text" name="phone" placeholder="æ‰‹æœºå·" />
        <input type="email" name="email" placeholder="é‚®ç®±" />
        <select name="role">
            <option value="buyer">ä¹°å®¶</option>
            <option value="seller">å–å®¶</option>
            <option value="both">ä¹°å®¶å’Œå–å®¶</option>
        </select>
        <button type="submit">æ³¨å†Œ</button>
    </form>
    <div class="msg" id="msg"></div>

    <script>
        const form = document.getElementById('registerForm');
        form.addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(form);
            const jsonData = Object.fromEntries(formData.entries());

            const res = await fetch('/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(jsonData)
            });

            const result = await res.json();
            const msg = document.getElementById('msg');
            msg.textContent = result.message || result.error;
            msg.className = result.error ? 'error' : 'msg';
        });
    </script>
</body>
</html>
